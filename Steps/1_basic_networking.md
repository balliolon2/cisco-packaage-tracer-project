# Basic Networking

## Networking Fundamentals
- เป้าหมาย
    - สามารถเข้าใจว่า Network คืออะไร
- ลองคิดภาพตามผมนะครับ
    - แทน Network คือการสื่อสารกันภายในบริษัท
    - พวก PC/Laptop ก็จะเหมือนพนักงานในบริษัท
        - พนักงานเป็นผู้ส่ง/รับข้อมูล เช่นเดียวกับ PC
        - หัวใจหลักของงานเครือข่ายคือ “การให้ PC สื่อสารกันได้” — ไม่ว่าจะเป็นการแชร์ไฟล์, โหลดเว็บ, หรือส่งอีเมล
    - Switch คือกลุ่มจัดเอกสารในแผนกเดียวกัน
        - Switch ทำหน้าที่กระจายข้อมูลเฉพาะคนใน LAN เดียว ทำให้เหมือนกับกลุ่มจัดเอกสารที่ส่งเฉพาะคนในแผนก
        - ปัญหาส่วนใหญ่ใน LAN มาจากการเชื่อมต่อและ MAC Address Table ฉนั้น Switch คือหัวใจของ Layer 2 (เดี๋ยวผมอธิบาย OSI Layer ภายหลัง)
    - Router คือกลุ่มประสานงานระหว่างแผนก
        - เมื่อข้อมูลจะออกไปนอกแผนก (LAN) ก็ต้องผ่าน Router ซึ่ง ก็เหมือนการประสานงานกับแผนกอื่น
        - Key หลักของ Routing คือการกำหนดเส้นทางไปยัง Subnet ปลายทาง (เดี๋ยวผมอธิบายภายหลังว่าคืออะไร)
    - Server คือห้องเก็บเอกสารส่วนกลาง
        - เป็นแหล่งข้อมูลหลัก เช่นเดียวกับ Server ที่ให้บริการ Web, FTP, DNS
        - หัวใจหลักของเครือข่ายองค์กรคือการเข้าถึง Server ไม่ว่าจะเป็น File Server, Web Server, หรือ Database
    - Firewall คือ รปภ.ในบริษัท
        - ควบคุมว่าใครเข้าออกได้บ้าง — ป้องกันไม่ให้คนนอกแอบเข้ามา
        - Key หลักของ Security Policy คือการจำกัดการเข้าถึง — ใช้ Firewall หรือ ACL เพื่อบล็อก Traffic ที่ไม่พึงประสงค์
    - IP Address คือรหัสประจำตัวพนักงาน
        - ระบุตำแหน่งของอุปกรณ์ในเครือข่าย — คล้ายกับการมีเลขพนักงานเพื่อแยกแยะว่าใครเป็นใคร
        - ปัญหาเครือข่ายหลายครั้งเกิดจากเกิดจาก IP Conflict หรือ IP ผิด Subnet — เข้าใจ IP แล้ว ปัญหาหลายอย่างหายไป
    - MAC Address คือรหัสประชาชนของพนักงาน
        - ระบุตัวตนของอุปกรณ์ในระดับคล้ายเลขประชาชนของเรา — ไม่ซ้ำกันในโลกจริง เพราะพวกอุปกรณ์จะถูกตั้ง MAC Address มาตั้งแต่ในโรงงานเลย
        - เนื้อหาส่วนใหญ่ของ Layer 2 คือการใช้ MAC Address เพื่อส่งข้อมูล 
- ![Basic Network](../img/1.jpg)

## ประเภทของ Network
- ![Network Type](../img/2.png)
- Local Area Network (LAN)
    - เปรียบเหมือน “บ้าน” หรือ “สำนักงานเล็ก ๆ” ที่คนภายในสามารถพูดคุยกันและแบ่งปันของใช้ร่วมกัน เช่น ปริ้นเตอร์ ไฟล์เอกสาร
    - ระยะทางไม่ไกลมาก (ประมาณ 100 เมตร)
    - ใช้เทคโนโลยีเช่น Ethernet, Wi-Fi
    - มักพบใช้บ้าน, โรงเรียน, ออฟฟิศขนาดเล็ก
- Metropolitan Area Network (MAN)
    - ครอบคลุมทั้งเมือง อาจยาวถึง 40 กิโลเมตร
    - ใช้เชื่อมต่อหลายสาขาขององค์กรเดียวกันในเมืองเดียวกัน
    - ตัวอย่าง: เครือข่ายมหาวิทยาลัย
- Wide Area Network (WAN)
    - ครอบคลุมพื้นที่กว้างมาก เช่น อินเทอร์เน็ต
    - ใช้เทคโนโลยีเช่น สายเคเบิลใต้ทะเล, ดาวเทียม หรือบริการจากผู้ให้บริการอินเทอร์เน็ต


## OSI Model และ TCP/IP Model
- ### OSI model
    - OSI Model เป็นแบบแผนหรือโมเดลที่แบ่งการทำงานของเครือข่ายออกเป็น 7 ชั้น (Layers)
    - 
    | Layer | ชื่อ Layer | หน้าที่หลัก | การเปรียบเทียบ |
    |-------|-------------|--------------|------------------|
    | **7** | Application Layer | ผู้ใช้โต้ตอบกับแอป เช่น อีเมล, เว็บ | เปรียบเสมือน **คุณ** ที่เขียนจดหมายหรือเปิดอ่านจดหมาย |
    | **6** | Presentation Layer | แปลงข้อมูล เช่น เข้ารหัส, บีบอัดไฟล์ | เปรียบเหมือน **นักแปลภาษา** หรือคนจัดรูปแบบเอกสาร |
    | **5** | Session Layer | จัดการเซสชัน เช่น เริ่ม/จบการเชื่อมต่อ | เปรียบเหมือน **พนักงานรับพัสดุ** ที่เริ่มกระบวนการส่งของ |
    | **4** | Transport Layer | ส่งข้อมูลจากต้นทางถึงปลายทาง เช่น TCP/UDP | เปรียบเหมือน **ศูนย์คัดแยกพัสดุ** ที่แบ่งจดหมายเป็นชิ้นเล็กๆ |
    | **3** | Network Layer | กำหนดเส้นทางการส่ง เช่น IP Address, Routing | เปรียบเหมือน **แผนกวางแผนเส้นทาง** ที่ใส่ที่อยู่และหาเส้นทาง |
    | **2** | Data Link Layer | ส่งข้อมูลในเครือข่ายเดียวกัน เช่น MAC Address | เปรียบเหมือน **รถส่งพัสดุในพื้นที่** ที่ส่งจดหมายในเขตใกล้เคียง |
    | **1** | Physical Layer | ส่งข้อมูลเป็น bits (0s และ 1s) ผ่านสายหรือคลื่น | เปรียบเหมือน **ถนนหรือสายไฟ** ที่รถใช้วิ่ง |
    - ### ตัวอย่าง Flowchart เทียบกับการกดเข้า Google:
    ```
    [User พิมพ์ www.google.com]
            ↓
    [Application Layer: HTTP/HTTPS Request]
            ↓
    [Presentation Layer: TLS/SSL (Encryption), Data Encoding]
            ↓
    [Session Layer: จัดการการเชื่อมต่อ/เริ่ม session กับ server]
            ↓
    [Transport Layer: TCP segment (Port 443 สำหรับ HTTPS)]
            ↓
    [Network Layer: IP packet (เช่น IPv4)]
            ↓
    [Data Link Layer: Ethernet Frame (MAC Address, ARP)]
            ↓
    [Physical Layer: ส่งสัญญาณผ่านสาย/คลื่นวิทยุ]
    ```
    - Layer 1 Physical Layer
        - หน้าที่หลักคือ "ส่งข้อมูลในรูปแบบของบิต (0s และ 1s)"  ผ่านสื่อกลางทางกายภาพ เช่น สายเคเบิล หรือคลื่นวิทยุ ไม่สนใจว่าข้อมูลคืออะไร แค่ทำให้มันไปถึงอีกฝั่งโดยไม่เสียหายเท่านั้น
        - คิดภาพตามว่า มันคือ โครงสร้างถนน/ระบบขนส่ง
            - สายไฟฟ้า / ใยแก้วนำแสง / Wi-Fi = เส้นทาง ทางถนน / ทางรถไฟ / ทางอากาศ
            - Timing & Interface = สัญญาณไฟจราจร / ป้ายบอกทาง
            - Repeater = ศูนย์บำรุงรักษาถนน
            - Hub = แยกไฟแดง / ทางเข้าออกหลายทาง
        - ส่วนประกอบสำคัญ
            - บิต (Bits): หน่วยข้อมูลพื้นฐาน
            - สื่อกลาง (Medium)
                - สายทองแดง: ใช้กระแสไฟฟ้าแทน 0/1
                - ไฟเบอร์ออปติก: ใช้แสงแทน 0/1
                - Wi-Fi: ใช้คลื่นวิทยุแทน 0/1
            - อุปกรณ์ Layer 1
                - Repeater: ขยายสัญญาณให้ไกลขึ้น
                - Hub: ส่งข้อมูลไปทุกทาง
                - NIC (Network Interface Card): แปลงข้อมูลเป็นสัญญาณทางกายภาพ
        - คำถามชวนคิด
            - ถ้า Layer 1 มีปัญหา จะเกิดอะไรขึ้น?
                - ข้อมูลจะไม่สามารถส่งไปยัง Layer อื่น ๆ ได้เลย
                - เช่น สายขาด, สัญญาณรบกวน → ข้อมูลไม่ไปถึงปลายทาง
            - ทำไม Layer 1 ถึงไม่สนใจเนื้อหาของข้อมูล?
                - เพราะ Layer 1 ทำหน้าที่เป็น “ถนน” เท่านั้น ไม่รู้ว่าข้อมูลคือภาพ, ข้อความ หรือเสียง แค่ทำให้มันไปถึงอีกฝั่ง
        - ตัวอย่างสถานการณ์
            - สถานการณ์: ขณะวิดีโอคอล Wi-Fi จู่ ๆ ก็กระตุก
                - สาเหตุที่อาจเกิดจาก Layer 1:  
                    - มีสัญญาณรบกวน เช่น จากไมโครเวฟหรือเตาอบ
                    - Router มีปัญหาทางไฟฟ้า
                    - สัญญาณอ่อน หรือระยะห่างมากเกินไป
                - สิ่งที่คุณจะสังเกตเห็น:  
                    - ภาพค้าง / เสียงหาย
                    - วิดีโอโหลดช้า
                    - บางครั้งหลุดออกจากวิดีโอคอล
    - Layer 2 Data Link Layer
        - หน้าที่หลักคือ 
            - แปลงบิตเป็นเฟรม (Frame) และส่งข้อมูลระหว่างอุปกรณ์ในเครือข่ายเดียวกัน เช่น ในออฟฟิศหรือบ้านเดียวกัน
            - กำหนด MAC Address: ระบุว่าใครเป็นผู้ส่งและผู้รับ
            - สร้าง Frame จากบิตข้อมูล และตรวจจับข้อผิดพลาด
            - Error Detection เช่น CRC (Cyclic Redundancy Check)
            - ควบคุมการไหล (Flow Control):  ไม่ให้ส่งข้อมูลเร็วเกินกว่าจะรับไหว
            - แก้ไขข้อผิดพลาด (Error Correction):  หากพบข้อผิดพลาด → ส่งใหม่ (ARQ)
            - จัดการการเข้าถึงสื่อกลาง (Medium Access Control):  เช่น CSMA/CD (สำหรับ Ethernet), CSMA/CA (สำหรับ Wi-Fi)
        - Sublayers ของ Data Link Layer (ตาม IEEE 802)
            - LLC (Logical Link Control): เชื่อมโยงกับ Network Layer
            - MAC (Media Access Control): จัดการการเข้าถึงสื่อกลาง (เช่น การส่งข้อมูลบนสาย LAN หรือคลื่น Wi-Fi)
        - อุปกรณ์ Layer 2
            - Switch: อุปกรณ์ฉลาดที่สุดใน Layer 2 — รู้ว่าอุปกรณ์ไหนอยู่พอร์ตไหน
            - Bridge:  เชื่อมต่อสองเครือข่ายย่อย
            - NIC (Network Interface Card):  สร้างและอ่าน Frame
        - คำถามชวนคิด
            - ทำไม Layer 2 ถึงใช้ MAC Address แทน IP Address?
                - เพราะ Layer 2 ทำงานในระดับท้องถิ่น (Local Network)
                - IP Address ใช้ใน Layer 3 เพื่อส่งข้อมูลข้ามเครือข่าย
        - ตัวอย่างสถานการณ์
            - ออกแบบเครือข่ายไร้สายสำหรับออฟฟิศใหญ่ ต้องการความน่าเชื่อถือ + ประสิทธิภาพสูง โดยใช้ Layer 2 แก้ปัญหา
                - ความน่าเชื่อถือสูงในเครือข่ายไร้สาย: เครือข่ายไร้สาย (Wireless LANs - 802.11) เป็นช่องสัญญาณที่มีข้อผิดพลาดสูงโดยธรรมชาติ
                    - Acknowledgements (ACK):  ทุกครั้งที่ส่งเฟรม จะรอตอบรับ (ACK) ถ้าไม่ได้รับภายในเวลา → ส่งใหม่
                    - Sequence Numbers:  ช่วยให้รู้ว่าเฟรมไหนมาผิดลำดับ หรือซ้ำ ช่วยให้ผู้รับสามารถตรวจจับเฟรมที่ซ้ำกัน (duplicates) และจัดเรียงเฟรมที่ได้รับนอกลำดับให้ถูกต้อง
                - ประสิทธิภาพที่ดีและการจัดการช่องสัญญาณ (Medium Access Control)
                    - Carrier Sense Multiple Access with Collision Avoidance (CSMA/CA):  ใช้ใน Wi-Fi เพื่อลดการชนกันของสัญญาณ
                    - Request To Send/Clear To Send (RTS/CTS):  ป้องกัน Hidden Terminal Problem
                    - NAV (Network Allocation Vector):  บอกว่าสัญญาณจะว่างเมื่อไหร่ โดยเป็นตัวจับเวลาภายในที่บอกอุปกรณ์ว่าช่องสัญญาณจะว่างเมื่อใด โดยอิงจากข้อมูลระยะเวลาที่ส่งในเฟรม RTS/CTS
                    - Quality of Service (QoS): มีกลไกการกำหนดลำดับความสำคัญของข้อมูล (เช่น AIFS - Arbitration InterFrame Space) ที่ช่วยให้ข้อมูลสำคัญ เช่น เสียงหรือวิดีโอ มีโอกาสเข้าถึงช่องสัญญาณได้เร็วกว่าข้อมูลปกติ
        - คำถามสถานการณ์นอกกรอบ
            - สมมติว่าคุณมีอุปกรณ์ Data Link Layer (เช่น Switch) ที่ 'ฉลาด' เกินไป มันพยายามที่จะ 'อ่าน' ข้อมูลที่อยู่ใน Payload (ซึ่งเป็น Packet ของ Network Layer) เพื่อตัดสินใจในการส่งต่อเฟรม แทนที่จะใช้แค่ MAC Address ใน Header Data Link Layer ตามปกติ คุณคิดว่าจะมีข้อดีและข้อเสียอย่างไรบ้างจากพฤติกรรมนี้?
                - ข้อดี
                    - การตัดสินใจส่งต่อที่ 'ฉลาดขึ้น': หาก Switch สามารถอ่าน IP Address (จาก Payload) หรือแม้กระทั่ง Port Number (จาก Transport Layer Header ที่อยู่ภายใน Payload ของ Layer 2) มันอาจจะสามารถทำการ "Routing" หรือ "Filtering" ที่ละเอียดอ่อนกว่าเดิมได้ใน Layer 2 เอง เช่น อาจจะส่งเฟรมเฉพาะไปยัง Switch หรือ Router ที่รับผิดชอบ IP Network นั้นๆ โดยตรงโดยไม่ต้องรอให้ถึง Layer 3 ตัดสินใจก่อน
                    - การปรับปรุง QoS ที่ละเอียดอ่อนกว่า: อาจจะสามารถจัดลำดับความสำคัญของเฟรมตามชนิดของแอปพลิเคชัน (เช่น การตรวจจับว่านี่คือ Video Streaming Packet) โดยไม่ต้องใช้ VLAN หรือกลไก QoS อื่นๆ ที่ซับซ้อน
                    - การจัดการความปลอดภัยแบบ Layer 2.5/3: อาจนำไปสู่การพัฒนา "Firewall" หรือ "Traffic Shaper" ที่ทำงานในระดับใกล้เคียง Layer 2 แต่มีข้อมูลจาก Layer 3/4 เพื่อตัดสินใจ
                - ข้อเสีย
                    - การละเมิดหลักการแบ่งชั้น (Layer Violation): นี่คือข้อเสียที่ใหญ่ที่สุดและสำคัญที่สุด. Data Link Layer ควรรับผิดชอบเฉพาะการส่งเฟรมระหว่างอุปกรณ์ที่ติดกันโดยตรงเท่านั้น และไม่ควร "สนใจ" หรือ "อ่าน" ข้อมูลที่อยู่ภายใน Payload ซึ่งเป็นของ Layer ที่สูงกว่า
                    - ความซับซ้อนและการบำรุงรักษา: การที่ Layer 2 ต้องเข้าใจ Header ของ Layer 3 หรือสูงกว่า จะเพิ่มความซับซ้อนในการออกแบบและการบำรุงรักษาอุปกรณ์อย่างมหาศาล
                    - ประสิทธิภาพลดลง (Potential Performance Hit): การที่ Switch ต้องประมวลผลข้อมูลใน Payload ที่มีขนาดใหญ่ขึ้น เพื่อทำการตัดสินใจ อาจทำให้เกิด Latency (ความหน่วง) เพิ่มขึ้นอย่างมีนัยสำคัญ
                    - ปัญหาความเข้ากันได้ (Compatibility Issues): หาก Switch ตัวหนึ่งอ่าน Payload แต่ Switch อีกตัวไม่ทำตามมาตรฐาน อาจเกิดปัญหาในการส่งข้อมูล
                    - ความเสี่ยงด้านความปลอดภัย: การที่อุปกรณ์ Layer 2 สามารถเข้าถึง Payload ได้ อาจทำให้เกิดช่องโหว่ด้านความปลอดภัยใหม่ๆ
                - สรุป
                    - แม้จะมีข้อดีที่ดูเหมือนจะทำให้เครือข่าย "ฉลาดขึ้น" แต่ในทางปฏิบัติแล้ว การที่ Layer 2 ไปยุ่งกับข้อมูลของ Layer ที่สูงกว่าถือเป็นการละเมิดหลักการออกแบบเครือข่ายแบบ Layered Model อย่างร้ายแรง และจะนำมาซึ่งความซับซ้อน ปัญหาด้านประสิทธิภาพ และความเข้ากันได้ในระยะยาว
                    - นี่คือเหตุผลว่าทำไม Switch จึงควรทำงานที่ Layer 2 โดยใช้ MAC Address เป็นหลักในการตัดสินใจ
    - Layer 3 Network Layer
        - มีหน้าที่หลักคือ
            - การระบุที่อยู่เชิงตรรกะ (Logical Addressing) เช่น IP address
            - การกำหนดเส้นทาง (Routing)
            - การส่งต่อแพ็กเก็ต (Packet Forwarding)
            - การให้บริการแบบ Connectionless หรือ Connection-Oriented
            - การแยกและประกอบแพ็กเก็ต (Fragmentation and Reassembly)
            - การทำงานร่วมกับเลเยอร์อื่น เช่น Transport และ Data Link Layer
        - คิดภาพว่ามันคือ ระบบ GPS ตามพัสดุ
            - Packet = พัสดุ
                - คือหน่วยข้อมูลที่มีที่อยู่ปลายทาง (IP Address) กำกับไว้
            - Router = ศูนย์คัดแยกพัสดุ
                - คืออุปกรณ์ที่รับ Packet มาแล้วตัดสินใจว่าจะส่งไปที่ไหนต่อ
            - Routing Table & Algorithm = ระบบ GPS
                - Router ใช้ตารางเส้นทางเพื่อเลือกเส้นทางที่ดีที่สุด
            - Fragmentation = การแบ่งพัสดุขนาดใหญ่
                - หากพัสดุใหญ่เกินรถบรรทุก ศูนย์จะแยกออกเป็นชิ้นเล็ก ๆ แล้วส่งไปทีละชิ้น
        - ตัวอย่างสถานการณ์
            - สมมติว่า Host A (IP: 192.168.1.10) ต้องการส่งข้อมูลไปยัง Host B (IP: 10.0.0.5) ซึ่งอยู่คนละเครือข่าย และ Host A มี Default Gateway ที่ Router R1 (IP: 192.168.1.1) อธิบายว่า Network Layer ที่ Host A และ Router R1 จะทำอะไรบ้าง?
                - ที่ Host A (Network Layer)
                    1. Network Layer ของ Host A จะรับข้อมูลเป็น Segment จาก Transport Layer
                    2. จะตรวจสอบ IP Address ปลายทาง (10.0.0.5) เทียบกับ IP Address และ Subnet Mask ของตัวเอง (192.168.1.10)
                    3. พบว่าปลายทางอยู่นอกเครือข่ายท้องถิ่น (ต่าง Network)
                    4. จึงเปลี่ยน Segment เป็น Packet และระบุ IP Source เป็น 192.168.1.10 และ IP Destination เป็น 10.0.0.5
                    5. จากนั้นจะส่ง Packet นี้ไปยัง Default Gateway (Router R1) เพื่อให้ Data Link Layer สามารถส่ง Frame ไปยัง MAC Address ของ R1 ได้
                - ที่ Router R1 (Network Layer)
                    1. Router R1 จะได้รับ Frame จาก Data Link Layer และทำการ De-encapsulate โดยถอด Header/Trailer ของ Layer 2 ออก
                    2. ตรวจสอบ Packet Header ของ Layer 3 (IP Header)
                    3. ดู IP Destination Address (10.0.0.5) และทำการตัดสินใจ Routing โดยใช้ Routing Table ของตัวเอง เพื่อหาเส้นทางที่ดีที่สุดในการส่ง Packet ไปยัง Network 10.0.0.0/8
                    4. หาก Packet มีขนาดใหญ่เกินไปสำหรับลิงก์ถัดไป Network Layer ของ R1 อาจทำการ Fragment Packet ให้เป็นชิ้นเล็กๆ
                    5. เราเตอร์ R1 จะสร้าง Frame ใหม่ โดยมี IP Packet เดิมอยู่ข้างใน พร้อมกับ MAC Address ของเราเตอร์ตัวถัดไปในเส้นทาง
                    6. ส่ง Frame นี้ไปยัง Physical Layer เพื่อส่งต่อบนลิงก์ถัดไป
            - ทำไม IP address ถึงสำคัญต่อการสื่อสารข้ามเครือข่าย (internetwork) ในขณะที่ MAC address ไม่ใช่?
                - MAC Address:  ใช้ในเครือข่ายเดียวกันเท่านั้น ไม่มีลำดับชั้น
                - IP Address:  มีโครงสร้างลำดับชั้น → Router สามารถรู้ว่าอุปกรณ์อยู่ “ที่ไหน” ในโลก → ใช้สำหรับการสื่อสารข้ามเครือข่าย
            - เมื่อแพ็กเก็ตเดินทางผ่านเราเตอร์ Router จะทำอะไรกับ Header ของแพ็กเก็ต?
                - Encapsulation/Decapsulation ที่ Router
                    1. เมื่อ Frame ที่มีแพ็กเก็ตอยู่ภายในเดินทางมาถึง Router (จากลิงก์ขาเข้า) Router จะถอด Header และ Trailer ของ Data Link Layer (Layer 2) ออก
                    2. จากนั้น เราเตอร์จะตรวจสอบ Network Layer Header (IP Header) เพื่อดู IP Destination Address และตัดสินใจหาเส้นทาง
                    3. ตัวแพ็กเก็ตของ Network Layer (IP Packet) จะยังคงอยู่โดยไม่ถูกเปลี่ยนแปลงเนื้อหาหลัก  (ยกเว้นฟิลด์บางอย่าง เช่น Time-to-Live (TTL) ที่จะถูกลดลงทุกครั้งที่ผ่านเราเตอร์ และอาจมีการ Fragmentation หากจำเป็น)
                    4. เมื่อเราเตอร์ตัดสินใจเลือกเส้นทางขาออกได้แล้ว เราเตอร์จะสร้าง Data Link Layer Header และ Trailer ใหม่ ให้กับแพ็กเก็ตนั้น เพื่อให้เหมาะสมกับเทคโนโลยีของลิงก์ขาออกถัดไป (เช่น Ethernet, PPP, etc.)
                    5. จากนั้น Frame ใหม่นี้จะถูกส่งไปยัง Physical Layer เพื่อส่งต่อ
        - คำถามสถานการณ์นอกกรอบ
            - ถ้า IP Address ไม่ได้ถูกออกแบบมาให้เป็นลำดับชั้น (Hierarchical) เหมือน MAC Address แต่เป็นแบบ Flat Address Space ทั้งหมด อินเทอร์เน็ตจะยังทำงานได้ไหม?
                - ผลลัพธ์: อินเทอร์เน็ตในปัจจุบันคงทำงานไม่ได้หรือทำงานได้ไม่มีประสิทธิภาพอย่างมาก
                - ตาราง Routing จะใหญ่เกินจัดการ: หากทุกอุปกรณ์มีที่อยู่แบบ Flat (เหมือน MAC Address) เราเตอร์ทุกตัวจะต้องเก็บข้อมูลที่อยู่ของ ทุกอุปกรณ์ ในโลก ซึ่งมีจำนวนมหาศาล (หลายพันล้าน) ทำให้ตาราง Routing ใหญ่เกินกว่าจะเก็บในหน่วยความจำของเราเตอร์และอัปเดตได้ทันท่วงที
                - ไม่มี Aggregation: การจัดโครงสร้างแบบลำดับชั้นของ IP (เช่น Network Prefix) ทำให้สามารถรวมกลุ่ม IP Address เป็นกลุ่มใหญ่ๆ ได้ (Aggregation) ซึ่งช่วยลดขนาดของตาราง Routing ในเราเตอร์หลักได้อย่างมาก หากไม่มีสิ่งนี้ Routing จะไม่ Scalable.
                - ประสิทธิภาพต่ำ: การหาเส้นทางจะช้ามาก เพราะเราเตอร์ต้องค้นหาที่อยู่ปลายทางในตารางขนาดใหญ่ทั้งหมด ไม่สามารถใช้ Prefix เพื่อตัดสินใจแบบเร็วๆ ได้
            - ถ้า Network Layer ถูกออกแบบมาให้รับประกันการนำส่งข้อมูลที่น่าเชื่อถือ 100% (Reliable Delivery) เหมือน Transport Layer (TCP) จะเกิดอะไรขึ้น?
                - ผลลัพธ์: ประสิทธิภาพของเครือข่ายโดยรวมจะลดลงอย่างมาก และเกิดความซ้ำซ้อนที่ไม่จำเป็น
                - Overhead มหาศาลในทุกเราเตอร์: การรับประกันความน่าเชื่อถือ เช่น การยืนยันการรับ การส่งซ้ำ การจัดเรียงลำดับ จะต้องเกิดขึ้นในทุกๆ เราเตอร์ที่แพ็กเก็ตผ่านไป ซึ่งจะเพิ่มภาระการประมวลผล หน่วยความจำ และ Latency อย่างมากในทุก Hop
                - ความซ้ำซ้อน: แอปพลิเคชันบางประเภท (เช่น การสตรีมวิดีโอแบบ Real-time, Voice over IP) ไม่ต้องการความน่าเชื่อถือ 100% เพราะข้อมูลที่มาถึงช้าดีกว่าข้อมูลที่ผิดพลาดเล็กน้อย การมี Reliable Delivery ที่ Layer 3 จะเป็นการเพิ่มภาระที่ไม่จำเป็นสำหรับแอปพลิเคชันเหล่านี้
                - End-to-End Argument: หลักการออกแบบเครือข่ายที่เรียกว่า "End-to-End Argument" (ที่ David Clark และคนอื่นๆ เสนอ) แนะนำว่าฟังก์ชันที่ต้องมีความน่าเชื่อถือควรถูกจัดการที่ Layer ที่สูงที่สุดที่จำเป็น (เช่น Transport Layer) เพื่อให้ Layer ล่างๆ ทำงานได้เร็วและมีประสิทธิภาพที่สุด โดยเฉพาะเมื่อสิ่งนั้นสามารถทำได้อย่างถูกต้องแค่ที่ปลายทางเท่านั้น
    - Layer 4 Transport Layer
    - Layer 5 Session Layer
    - Layer 6 Presentation Layer
    - Layer 7 Application Layer
    - ลองคิดตามคำถามเหล่านี้เพื่อให้เข้าใจผลกระทบหากมีปัญหาในแต่ละ Layer
        - Layer 2 ตรวจจับข้อผิดพลาดไม่ได้จะเกิดอะไรขึ้น?
            - ข้อมูลที่เสียหายจะถูกส่งต่อไป → อาจทำให้ข้อมูลผิดเพี้ยน หรือโปรแกรมทำงานผิดปกติ
                - Layer 2 (Data Link Layer) มีหน้าที่หนึ่งคือ ตรวจจับข้อผิดพลาดของเฟรม (frame error detection) โดยใช้เทคนิคอย่าง CRC (Cyclic Redundancy Check) ที่ท้ายเฟรม
                - แต่ Data Link Layer ส่วนใหญ่ "ตรวจจับ" ได้ แต่ไม่แก้ไข (ไม่ correct) — มันแค่ ทิ้งเฟรมที่เสียหาย
                - หากไม่มีการตรวจสอบที่ชั้นบน ๆ เช่น:
                    - TCP อาจตรวจพบและร้องขอ retransmission (ถ้ามี)
                    - UDP จะไม่ตรวจสอบ → ส่งข้อมูลเสียไปเลย
                - โปรแกรมปลายทางอาจแสดงข้อมูลผิดเพี้ยน, เกิดการแครช หรือพฤติกรรมผิดปกติ
            - ตัวอย่างผลกระทบ
                - ดูวิดีโอออนไลน์ → ภาพ/เสียงกระตุกหรือแตก
                - รับไฟล์ผ่านเครือข่าย → ไฟล์เปิดไม่ได้หรือข้อมูลเสีย
                - คำสั่งจาก user → ถูกตีความผิด → โปรแกรมทำงานผิด
        - Layer 3 มีปัญหาจะเกิดอะไรขึ้น?
            - ไม่สามารถหาเส้นทางส่งข้อมูลไปยังเครือข่ายอื่นได้ → ข้อมูลไปไม่ถึงปลายทาง
                - ข้อมูลไปไม่ถึงปลายทาง → Packet ถูก drop
            - หากใช้ TCP จะเกิด Timeout และส่งใหม่หลายรอบจนล้มเหลว
                - TCP จะตรวจไม่พบ ACK → เกิด Timeout → Retransmit → ล้มเหลวในที่สุด
            - Application ปลายทางจะ ไม่ตอบสนอง หรือแสดง error
- ### TCP/IP model